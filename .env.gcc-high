# Latch Configuration - Azure Government GCC-High Cloud
# Copy to .env.local and fill in your values

# Azure AD Application (from Azure Government Portal → App Registrations)
# Portal: https://portal.azure.us
LATCH_CLIENT_ID=00000000-0000-0000-0000-000000000000
LATCH_TENANT_ID=11111111-1111-1111-1111-111111111111

# Cloud Environment (do not change for GCC-High)
LATCH_CLOUD=gcc-high

# OAuth Scopes (space-separated)
# IMPORTANT: Do NOT use https://graph.microsoft.com URLs
# Use simple scope names - Latch will use correct .us endpoints
#
# Common scopes:
#   openid profile        - Basic user info
#   User.Read             - Read user profile
#   Mail.Read             - Read user email
#   Calendars.Read        - Read user calendar
#   Files.Read            - Read user files
LATCH_SCOPES=openid profile User.Read

# OAuth Redirect URI (must match Azure AD app registration)
# Default: http://localhost:3000/api/latch/callback
# Production: https://yourapp.mil/api/latch/callback
LATCH_REDIRECT_URI=http://localhost:3000/api/latch/callback

# Cookie Encryption Secret (REQUIRED - generate with: openssl rand -base64 32)
# NEVER commit this to git!
# For GCC-High: Use FIPS-compliant generation if required
LATCH_COOKIE_SECRET=

# Debug Mode (optional, set to 'true' for verbose logging)
# Note: Tokens are NEVER logged, even in debug mode
LATCH_DEBUG=false

# Next.js URL (used if LATCH_REDIRECT_URI not set)
NEXTAUTH_URL=http://localhost:3000

# ============================================
# OPTIONAL: For Direct Token Mode (client-side)
# ============================================
# Only needed if using useAccessToken() hook
# NEXT_PUBLIC_LATCH_CLOUD=gcc-high
# NEXT_PUBLIC_LATCH_TENANT_ID=11111111-1111-1111-1111-111111111111

# ============================================
# Quick Start Checklist (GCC-High)
# ============================================
# 1. Go to Azure Government Portal (https://portal.azure.us)
# 2. Navigate to: App Registrations → Your App
# 3. Copy "Application (client) ID" → LATCH_CLIENT_ID
# 4. Copy "Directory (tenant) ID" → LATCH_TENANT_ID
# 5. Generate cookie secret: openssl rand -base64 32
# 6. Add to Authentication → Redirect URIs:
#    - http://localhost:3000/api/latch/callback (dev)
#    - https://yourapp.mil/api/latch/callback (prod)
# 7. Grant API permissions (Microsoft Graph):
#    - User.Read (delegated)
# 8. Restart Next.js dev server

# ============================================
# Azure Government Endpoints (Automatic)
# ============================================
# Latch automatically uses these endpoints for GCC-High:
#   - Login: https://login.microsoftonline.us
#   - Graph: https://graph.microsoft.us
#
# You do NOT need to specify these manually!

# ============================================
# Azure AD App Registration Settings
# ============================================
# Portal: https://portal.azure.us
#
# Platform: Web
# Redirect URIs:
#   - http://localhost:3000/api/latch/callback (dev)
#   - https://yourapp.mil/api/latch/callback (prod)
#
# Supported account types:
#   - Single tenant (most common for Gov)
#
# API permissions:
#   - Microsoft Graph → Delegated permissions
#   - User.Read (minimum)
#
# Certificates & secrets:
#   - NOT NEEDED (using PKCE)

# ============================================
# Common Issues (GCC-High)
# ============================================
# Error: "Cloud/Scope Mismatch"
#   → Do NOT use https://graph.microsoft.com in scopes
#   → Use simple names: User.Read (not https://graph.microsoft.com/User.Read)
#
# Error: "Tenant not found"
#   → Ensure you're using the GCC-High tenant ID (from portal.azure.us)
#   → NOT the commercial tenant ID (from portal.azure.com)
#
# Error: "Invalid redirect URI"
#   → Register redirect URI in Azure Government portal
#   → Use https in production (.mil domain)

# ============================================
# Compliance Notes
# ============================================
# Impact Level: IL4 (GCC-High)
# FedRAMP: High
# CJIS: Yes
# ITAR: Yes (with proper controls)
#
# Security recommendations:
#   - Use Secure Proxy mode (default) to keep tokens server-side
#   - Enable HTTPS in production (required)
#   - Rotate LATCH_COOKIE_SECRET every 90 days
#   - Review Azure AD sign-in logs regularly
