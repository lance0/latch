
> @latch/core@0.3.0 test /home/lance/latch/packages/latch
> vitest --run


 RUN  v2.1.9 /home/lance/latch/packages/latch

 ✓ __tests__/crypto/random.test.ts (7 tests) 18ms
 ✓ __tests__/crypto/pkce.test.ts (8 tests) 14ms
 ✓ __tests__/config.test.ts (9 tests) 17ms
 ✓ __tests__/security/scope-escalation.test.ts (18 tests) 19ms
 ✓ __tests__/oidc/tokens.test.ts (9 tests) 26ms
 ✓ __tests__/security/csrf.test.ts (12 tests) 7ms
 ✓ __tests__/oidc/validation.test.ts (12 tests) 16ms
 ✓ __tests__/security/open-redirect.test.ts (24 tests) 51ms
 ✓ __tests__/crypto/seal.test.ts (7 tests) 576ms
 ✓ __tests__/security/cookie-tampering.test.ts (12 tests) 825ms
stderr | __tests__/react/useAccessToken.test.ts > useAccessToken - Enhanced Auto-Refresh > Manual Refresh > should allow manual token refresh
An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

stderr | __tests__/react/useAccessToken.test.ts > useAccessToken - Enhanced Auto-Refresh > Manual Refresh > should clear error on successful manual refresh
An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

stderr | __tests__/react/useAccessToken.test.ts > useAccessToken - Enhanced Auto-Refresh > Retry Logic > should retry on failure with retryOnFailure enabled
[Latch] Token refresh failed (attempt 1/3), retrying in 1s...

stderr | __tests__/react/useAccessToken.test.ts > useAccessToken - Enhanced Auto-Refresh > Retry Logic > should retry on failure with retryOnFailure enabled
[Latch] Token refresh failed (attempt 2/3), retrying in 3s...

stderr | __tests__/react/useAccessToken.test.ts > useAccessToken - Enhanced Auto-Refresh > Retry Logic > should respect maxRetries limit
[Latch] Token refresh failed (attempt 1/2), retrying in 1s...

stderr | __tests__/react/useAccessToken.test.ts > useAccessToken - Enhanced Auto-Refresh > Retry Logic > should respect maxRetries limit
[Latch] Token refresh failed (attempt 2/2), retrying in 2s...

stderr | __tests__/react/useAccessToken.test.ts > useAccessToken - Enhanced Auto-Refresh > Retry Logic > should respect maxRetries limit
[Latch] Token refresh failed after max retries

 ✓ __tests__/react/useAccessToken.test.ts (17 tests) 10070ms
   ✓ useAccessToken - Enhanced Auto-Refresh > Configuration Options > should disable auto-refresh when autoRefresh is false 1559ms
   ✓ useAccessToken - Enhanced Auto-Refresh > Retry Logic > should retry on failure with retryOnFailure enabled 3978ms
   ✓ useAccessToken - Enhanced Auto-Refresh > Retry Logic > should respect maxRetries limit 3522ms

 Test Files  11 passed (11)
      Tests  135 passed (135)
   Start at  09:17:58
   Duration  11.91s (transform 759ms, setup 0ms, collect 2.22s, tests 11.64s, environment 11.40s, prepare 2.31s)

