# @latch/cli

**CLI tools for Latch authentication library**

Quickly generate secrets and initialize Latch configuration with an interactive wizard.

## Installation

```bash
# Global installation
npm install -g @latch/cli

# Or use with npx (no installation required)
npx @latch/cli [command]
```

## Commands

### `generate-secret`

Generate a cryptographically secure random secret for `LATCH_COOKIE_SECRET`:

```bash
npx @latch/cli generate-secret

# Output:
# ‚úì Generated secure cookie secret:
#
# LATCH_COOKIE_SECRET=ip+N8RAVD2jUtdKKQEqk9wgyNE8BHI/L8c5qYRnjVcM=
#
# Add this to your .env.local file
# Never commit this secret to version control!
```

**Alias:** `secret`

```bash
npx @latch/cli secret
```

### `init`

Interactive wizard to initialize Latch configuration:

```bash
npx @latch/cli init
```

The wizard will prompt you for:

1. **Cloud environment** - Azure Commercial, GCC-High, or DoD
2. **Azure AD Client ID** - Application (client) ID from Azure portal
3. **Azure AD Tenant ID** - Directory (tenant) ID from Azure portal
4. **OAuth Redirect URI** - Defaults to `http://localhost:3000/api/latch/callback`
5. **OAuth Scopes** - Defaults to `openid profile User.Read`

**Example session:**

```
üîê Latch Configuration Wizard

? Which Azure cloud environment? ‚Ä∫ Azure Government GCC-High (IL4)
? Azure AD Client ID (Application ID): ‚Ä∫ 00000000-0000-0000-0000-000000000000
? Azure AD Tenant ID (Directory ID): ‚Ä∫ 11111111-1111-1111-1111-111111111111
? OAuth Redirect URI: ‚Ä∫ http://localhost:3000/api/latch/callback
? OAuth Scopes (space-separated): ‚Ä∫ openid profile User.Read

‚úì Configuration complete!

Created: .env.local

Next steps:
  1. Review your .env.local file
  2. Create API routes in app/api/latch/
  3. Wrap your app with <LatchProvider>
  4. Run pnpm dev to start

‚ö†  Government Cloud Notes:
  ‚Ä¢ Register your app at https://portal.azure.us
  ‚Ä¢ Do NOT use .com Graph URLs in scopes
```

**Output:**

Creates a `.env.local` file with all required Latch configuration:

```env
# Latch Configuration - Azure Government GCC-High
# Generated by @latch/cli on 2025-10-22

# Azure AD Application
LATCH_CLIENT_ID=00000000-0000-0000-0000-000000000000
LATCH_TENANT_ID=11111111-1111-1111-1111-111111111111

# Cloud Environment
LATCH_CLOUD=gcc-high

# OAuth Configuration
LATCH_SCOPES=openid profile User.Read
LATCH_REDIRECT_URI=http://localhost:3000/api/latch/callback

# Cookie Encryption Secret (NEVER commit this!)
LATCH_COOKIE_SECRET=<automatically generated>

# Debug Mode (optional)
LATCH_DEBUG=false

# Next.js URL
NEXTAUTH_URL=http://localhost:3000
```

## Features

‚úÖ **Validates UUIDs** - Ensures Client ID and Tenant ID are valid UUID format
‚úÖ **Auto-generates secrets** - Creates cryptographically secure 32-byte secrets
‚úÖ **Cloud-specific defaults** - Provides appropriate defaults for each Azure cloud
‚úÖ **Government cloud warnings** - Reminds you about GCC-High/DoD requirements

## Usage in Monorepo

If you're developing in the Latch monorepo:

```bash
# From root
pnpm --filter @latch/cli build

# Run locally
node packages/latch-cli/dist/index.js generate-secret
node packages/latch-cli/dist/index.js init
```

## License

Apache License 2.0 - see [LICENSE](../../LICENSE)
